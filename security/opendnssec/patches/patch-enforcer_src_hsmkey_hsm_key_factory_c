$OpenBSD: patch-enforcer_src_hsmkey_hsm_key_factory_c,v 1.1 2021/11/28 10:37:04 sthen Exp $

Don't assume that LDNS >= 1.7 means that ed25519/ed448 support is present

Index: enforcer/src/hsmkey/hsm_key_factory.c
--- enforcer/src/hsmkey/hsm_key_factory.c.orig
+++ enforcer/src/hsmkey/hsm_key_factory.c
@@ -264,10 +264,12 @@ hsm_key_factory_generate(engine_type* engine, const db
             case LDNS_ECDSAP384SHA384:
                 key = hsm_generate_ecdsa_key(hsm_ctx, policy_key_repository(policy_key), "P-384");
                 break;
-#if (LDNS_REVISION >= ((1<<16)|(7<<8)|(0)))
+#if USE_ED25519
             case LDNS_ED25519:
                 key = hsm_generate_eddsa_key(hsm_ctx, policy_key_repository(policy_key), "edwards25519");
                 break;
+#endif
+#if USE_ED448
             case LDNS_ED448:
                 key = hsm_generate_eddsa_key(hsm_ctx, policy_key_repository(policy_key), "edwards448");
                 break;
