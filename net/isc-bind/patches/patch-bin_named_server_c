$OpenBSD: patch-bin_named_server_c,v 1.1 2021/02/25 16:37:22 sthen Exp $

From 2b3fcd7156808b9423cf91655dae45c08c180638 Mon Sep 17 00:00:00 2001
From: Mark Andrews <marka@isc.org>
Date: Mon, 25 Jan 2021 16:14:02 +1100
Subject: [PATCH 1/5] Pass an afg_aclconfctx_t structure to cfg_acl_fromconfig
in named_zone_inlinesigning.  A NULL pointer does not work.

Index: bin/named/server.c
--- bin/named/server.c.orig
+++ bin/named/server.c
@@ -6371,7 +6371,8 @@ configure_zone(const cfg_obj_t *config, const cfg_obj_
 	}
 
 	if (zone != NULL &&
-	    !named_zone_reusable(zone, zconfig, vconfig, config)) {
+	    !named_zone_reusable(zone, zconfig, vconfig, config, aclconf))
+	{
 		dns_zone_detach(&zone);
 	}
 
@@ -6451,8 +6452,8 @@ configure_zone(const cfg_obj_t *config, const cfg_obj_
 			      strcasecmp(ztypestr, "slave") == 0));
 
 	if (zone_maybe_inline) {
-		inline_signing = named_zone_inlinesigning(zone, zconfig,
-							  vconfig, config);
+		inline_signing = named_zone_inlinesigning(
+			zone, zconfig, vconfig, config, aclconf);
 	}
 	if (inline_signing) {
 		dns_zone_getraw(zone, &raw);
