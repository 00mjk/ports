$OpenBSD: patch-mesonbuild_interpreterbase_interpreterbase_py,v 1.1 2021/08/11 11:26:27 ajacoutot Exp $

From af280058b01d7970da9bb8fbad2966f9c72cf6a0 Mon Sep 17 00:00:00 2001
From: Daniel Mensinger <daniel@mensinger-ka.de>
Date: Sat, 31 Jul 2021 17:51:05 +0200
Subject: [PATCH] interpreter: Fix list contains for Holders (fixes #9020 #9047)

Index: mesonbuild/interpreterbase/interpreterbase.py
--- mesonbuild/interpreterbase/interpreterbase.py.orig
+++ mesonbuild/interpreterbase/interpreterbase.py
@@ -783,7 +783,7 @@ The result of this is undefined and will become a hard
                           posargs: T.List[TYPE_var],
                           kwargs: TYPE_kwargs) -> T.Union[TYPE_var, InterpreterObject]:
         if method_name == 'contains':
-            def check_contains(el: list) -> bool:
+            def check_contains(el: T.List[TYPE_var]) -> bool:
                 if len(posargs) != 1:
                     raise InterpreterException('Contains method takes exactly one argument.')
                 item = posargs[0]
@@ -795,7 +795,7 @@ The result of this is undefined and will become a hard
                     if element == item:
                         return True
                 return False
-            return check_contains(obj)
+            return check_contains([_unholder(x) for x in obj])
         elif method_name == 'length':
             return len(obj)
         elif method_name == 'get':
