$OpenBSD: patch-hotspot_make_bsd_makefiles_vm_make,v 1.1 2021/08/05 15:40:20 kurt Exp $

Fix configure arg -with-native-debug-symbols=internal

Index: hotspot/make/bsd/makefiles/vm.make
--- hotspot/make/bsd/makefiles/vm.make.orig
+++ hotspot/make/bsd/makefiles/vm.make
@@ -346,8 +346,10 @@ ifeq ($(ENABLE_FULL_DEBUG_SYMBOLS),1)
 	$(RM) -r $(LIBJVM_DEBUGINFO)
     endif
   else
+    ifneq ($(STRIP_POLICY),no_strip)
 	$(QUIETLY) $(OBJCOPY) --only-keep-debug $@ $(LIBJVM_DEBUGINFO)
 	$(QUIETLY) $(OBJCOPY) --add-gnu-debuglink=$(LIBJVM_DEBUGINFO) $@
+    endif
     ifeq ($(STRIP_POLICY),all_strip)
 	$(QUIETLY) $(STRIP) $@
     else
@@ -356,9 +358,11 @@ ifeq ($(ENABLE_FULL_DEBUG_SYMBOLS),1)
       # implied else here is no stripping at all
       endif
     endif
-    ifeq ($(ZIP_DEBUGINFO_FILES),1)
+    ifneq ($(STRIP_POLICY),no_strip)
+      ifeq ($(ZIP_DEBUGINFO_FILES),1)
 	$(ZIPEXE) -q -y $(LIBJVM_DIZ) $(LIBJVM_DEBUGINFO)
 	$(RM) $(LIBJVM_DEBUGINFO)
+      endif
     endif
   endif
 endif
