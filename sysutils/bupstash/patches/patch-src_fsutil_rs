$OpenBSD: patch-src_fsutil_rs,v 1.1 2021/08/01 17:08:41 bket Exp $

Taken from https://github.com/andrewchambers/bupstash/pull/231.

Index: src/fsutil.rs
--- src/fsutil.rs.orig
+++ src/fsutil.rs
@@ -353,6 +353,20 @@ cfg_if::cfg_if! {
             dev & 0xffffff
         }
 
+    } else if #[cfg(target_os = "openbsd")] {
+
+        pub fn makedev(major: u64, minor: u64) -> libc::dev_t {
+            (((major & 0xff) << 8) | (minor & 0xff) | ((minor & 0xffff00) << 8)) as libc::dev_t
+        }
+
+        pub fn dev_major(dev: u64) -> u64 {
+            (dev >> 8) & 0xff
+        }
+
+        pub fn dev_minor(dev :u64) -> u64 {
+            (dev & 0xff) | ((dev & 0xffff0000) >> 8)
+        }
+
     } else {
 
         pub fn makedev(major: u64, minor: u64) -> libc::dev_t {
